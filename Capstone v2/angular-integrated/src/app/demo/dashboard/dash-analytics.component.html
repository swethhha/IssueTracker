<div class="analytics-dashboard">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1>Analytics Dashboard</h1>
      <p>Comprehensive insights into your payroll system</p>
    </div>
    <div class="period-selector">
      <button 
        *ngFor="let period of ['weekly', 'monthly', 'quarterly']" 
        [class]="'period-btn ' + (selectedPeriod === period ? 'active' : '')"
        (click)="onPeriodChange(period)">
        {{ period | titlecase }}
      </button>
    </div>
  </div>

  <!-- KPI Cards -->
  <div class="kpi-grid">
    <div *ngFor="let kpi of kpiCards" [class]="'kpi-card ' + kpi.color">
      <div class="kpi-icon">
        <i class="material-icons-outlined">{{ kpi.icon }}</i>
      </div>
      <div class="kpi-content">
        <h3>{{ kpi.value }}</h3>
        <p>{{ kpi.title }}</p>
        <span [class]="'trend ' + kpi.trend">
          <i class="material-icons-outlined">{{ kpi.trend === 'up' ? 'arrow_upward' : 'arrow_downward' }}</i>
          {{ kpi.change }}
        </span>
      </div>
    </div>
  </div>

  <!-- Charts Grid -->
  <div class="charts-grid">
    <!-- Payroll Trend -->
    <div class="chart-card large">
      <div class="chart-header">
        <h3>Monthly Payroll Trend</h3>
        <span class="chart-subtitle">Last 6 months performance</span>
      </div>
      <apx-chart
        [series]="payrollTrendOptions.series!"
        [chart]="payrollTrendOptions.chart!"
        [xaxis]="payrollTrendOptions.xaxis!"
        [colors]="payrollTrendOptions.colors!"
        [fill]="payrollTrendOptions.fill!"
        [stroke]="payrollTrendOptions.stroke!"
        [dataLabels]="payrollTrendOptions.dataLabels!">
      </apx-chart>
    </div>

    <!-- Department Distribution -->
    <div class="chart-card">
      <div class="chart-header">
        <h3>Employee Distribution</h3>
        <span class="chart-subtitle">By department</span>
      </div>
      <apx-chart
        [series]="departmentOptions.series!"
        [chart]="departmentOptions.chart!"
        [labels]="departmentOptions.labels!"
        [colors]="departmentOptions.colors!"
        [legend]="departmentOptions.legend!"
        [dataLabels]="departmentOptions.dataLabels!">
      </apx-chart>
    </div>

    <!-- Weekly Activity -->
    <div class="chart-card">
      <div class="chart-header">
        <h3>Weekly Activity</h3>
        <span class="chart-subtitle">Applications & requests</span>
      </div>
      <apx-chart
        [series]="weeklyActivityOptions.series!"
        [chart]="weeklyActivityOptions.chart!"
        [xaxis]="weeklyActivityOptions.xaxis!"
        [colors]="weeklyActivityOptions.colors!"
        [plotOptions]="weeklyActivityOptions.plotOptions!"
        [dataLabels]="weeklyActivityOptions.dataLabels!">
      </apx-chart>
    </div>

    <!-- Approval Status -->
    <div class="chart-card">
      <div class="chart-header">
        <h3>Approval Rates</h3>
        <span class="chart-subtitle">Current month</span>
      </div>
      <apx-chart
        [series]="approvalStatusOptions.series!"
        [chart]="approvalStatusOptions.chart!"
        [labels]="approvalStatusOptions.labels!"
        [colors]="approvalStatusOptions.colors!"
        [plotOptions]="approvalStatusOptions.plotOptions!">
      </apx-chart>
    </div>
  </div>

  <!-- Bottom Section -->
  <div class="bottom-grid">
    <!-- Recent Activities -->
    <div class="activity-card">
      <div class="card-header">
        <h3>Recent Activities</h3>
        <button class="view-all-btn">View All</button>
      </div>
      <div class="activity-list">
        <div *ngFor="let activity of recentActivities" class="activity-item">
          <div class="activity-avatar">{{ activity.user.split(' ').map(n => n[0]).join('') }}</div>
          <div class="activity-content">
            <p><strong>{{ activity.user }}</strong> {{ activity.action }}</p>
            <span class="activity-amount">{{ activity.amount }}</span>
            <span class="activity-time">{{ activity.time }}</span>
          </div>
          <div [class]="'activity-status ' + activity.status">{{ activity.status }}</div>
        </div>
      </div>
    </div>

    <!-- Top Performers -->
    <div class="performers-card">
      <div class="card-header">
        <h3>Top Performers</h3>
        <span class="subtitle">This month</span>
      </div>
      <div class="performers-list">
        <div *ngFor="let performer of topPerformers; let i = index" class="performer-item">
          <div class="performer-rank">{{ i + 1 }}</div>
          <div class="performer-avatar">{{ performer.avatar }}</div>
          <div class="performer-info">
            <p class="performer-name">{{ performer.name }}</p>
            <span class="performer-dept">{{ performer.department }}</span>
          </div>
          <div class="performer-score">{{ performer.score }}%</div>
        </div>
      </div>
    </div>
  </div>
</div>